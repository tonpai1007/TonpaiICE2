// src/errorMessages.js - Centralized error messages with helpful guidance

const ERROR_MESSAGES = {
  // Parsing errors
  CANNOT_PARSE: {
    message: 'âŒ à¹„à¸¡à¹ˆà¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¸„à¸³à¸ªà¸±à¹ˆà¸‡',
    help: [
      'ðŸ’¡ à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸—à¸µà¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡:',
      'â€¢ "à¹€à¸ˆà¹‰à¹à¸­à¸™ à¸ªà¸±à¹ˆà¸‡ à¹‚à¸„à¹‰à¸ 30 à¸ˆà¸³à¸™à¸§à¸™ 5"',
      'â€¢ "à¸™à¹‰à¸³à¹à¸‚à¹‡à¸‡à¸«à¸¥à¸­à¸” 20 2 à¸–à¸¸à¸‡"',
      'â€¢ "à¹€à¸•à¸´à¸¡ à¸™à¹‰à¸³à¹à¸‚à¹‡à¸‡ 20 50"',
      '',
      'à¸žà¸´à¸¡à¸žà¹Œ "help" à¹€à¸žà¸·à¹ˆà¸­à¸”à¸¹à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸‰à¸šà¸±à¸šà¹€à¸•à¹‡à¸¡'
    ]
  },
  
  AMBIGUOUS_PRODUCT: (productName, matches) => ({
    message: `ðŸ¤” à¸žà¸šà¸ªà¸´à¸™à¸„à¹‰à¸² "${productName}" à¸«à¸¥à¸²à¸¢à¸£à¸²à¸¢à¸à¸²à¸£`,
    help: [
      'à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸à¹à¸šà¸šà¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£:',
      '',
      ...matches.slice(0, 5).map((m, i) => 
        `${i + 1}. ${m.item} - ${m.price}à¸¿ (à¹€à¸«à¸¥à¸·à¸­ ${m.stock} ${m.unit})`
      ),
      '',
      'ðŸ’¡ à¸§à¸´à¸˜à¸µà¸£à¸°à¸šà¸¸à¹ƒà¸«à¹‰à¸Šà¸±à¸”à¹€à¸ˆà¸™:',
      `à¸žà¸´à¸¡à¸žà¹Œ: "${productName} [à¸£à¸²à¸„à¸²] [à¸ˆà¸³à¸™à¸§à¸™]"`,
      `à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡: "${productName} ${matches[0].price} 2"`
    ]
  }),
  
  // Stock errors
  OUT_OF_STOCK: (item, requested, available) => ({
    message: `âŒ à¸ªà¸•à¹‡à¸­à¸à¹„à¸¡à¹ˆà¸žà¸­: ${item}`,
    help: [
      `ðŸ“Š à¸ªà¸–à¸²à¸™à¸°:`,
      `â€¢ à¸¡à¸µà¸­à¸¢à¸¹à¹ˆ: ${available} ${item.unit || 'à¸Šà¸´à¹‰à¸™'}`,
      `â€¢ à¸•à¹‰à¸­à¸‡à¸à¸²à¸£: ${requested} ${item.unit || 'à¸Šà¸´à¹‰à¸™'}`,
      `â€¢ à¸‚à¸²à¸”: ${requested - available} ${item.unit || 'à¸Šà¸´à¹‰à¸™'}`,
      '',
      'ðŸ’¡ à¸—à¸²à¸‡à¹€à¸¥à¸·à¸­à¸:',
      'â€¢ à¸ªà¸±à¹ˆà¸‡à¸™à¹‰à¸­à¸¢à¸¥à¸‡',
      'â€¢ à¸•à¸´à¸”à¸•à¹ˆà¸­à¹à¸­à¸”à¸¡à¸´à¸™à¹€à¸žà¸·à¹ˆà¸­à¹€à¸•à¸´à¸¡à¸ªà¸•à¹‡à¸­à¸'
    ]
  }),
  
  PRODUCT_NOT_FOUND: (productName) => ({
    message: `âŒ à¹„à¸¡à¹ˆà¸žà¸šà¸ªà¸´à¸™à¸„à¹‰à¸²: ${productName}`,
    help: [
      'ðŸ’¡ à¸—à¸³à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£:',
      'â€¢ à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸Šà¸·à¹ˆà¸­à¸ªà¸´à¸™à¸„à¹‰à¸² (à¸­à¸²à¸ˆà¸žà¸´à¸¡à¸žà¹Œà¸œà¸´à¸”)',
      'â€¢ à¸žà¸´à¸¡à¸žà¹Œ "à¸ªà¸•à¹‡à¸­à¸" à¹€à¸žà¸·à¹ˆà¸­à¸”à¸¹à¸£à¸²à¸¢à¸à¸²à¸£à¸ªà¸´à¸™à¸„à¹‰à¸²à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”',
      'â€¢ à¸•à¸´à¸”à¸•à¹ˆà¸­à¹à¸­à¸”à¸¡à¸´à¸™à¸«à¸²à¸à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹€à¸žà¸´à¹ˆà¸¡à¸ªà¸´à¸™à¸„à¹‰à¸²à¹ƒà¸«à¸¡à¹ˆ'
    ]
  }),
  
  // Order errors
  ORDER_NOT_FOUND: (orderNo) => ({
    message: `âŒ à¹„à¸¡à¹ˆà¸žà¸šà¸­à¸­à¹€à¸”à¸­à¸£à¹Œ #${orderNo}`,
    help: [
      'ðŸ’¡ à¸à¸£à¸¸à¸“à¸²à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š:',
      'â€¢ à¹€à¸¥à¸‚à¸­à¸­à¹€à¸”à¸­à¸£à¹Œà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ',
      'â€¢ à¸žà¸´à¸¡à¸žà¹Œ "à¸­à¸­à¹€à¸”à¸­à¸£à¹Œà¸¥à¹ˆà¸²à¸ªà¸¸à¸”" à¹€à¸žà¸·à¹ˆà¸­à¸”à¸¹à¸­à¸­à¹€à¸”à¸­à¸£à¹Œà¸¥à¹ˆà¸²à¸ªà¸¸à¸”',
      'â€¢ à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¸£à¸°à¸šà¸¸à¹€à¸¥à¸‚ à¸£à¸°à¸šà¸šà¸ˆà¸°à¹ƒà¸Šà¹‰à¸­à¸­à¹€à¸”à¸­à¸£à¹Œà¸¥à¹ˆà¸²à¸ªà¸¸à¸”à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´'
    ]
  }),
  
  INVALID_QUANTITY: (quantity) => ({
    message: `âŒ à¸ˆà¸³à¸™à¸§à¸™à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: ${quantity}`,
    help: [
      'ðŸ“‹ à¸‚à¹‰à¸­à¸à¸³à¸«à¸™à¸”:',
      'â€¢ à¸ˆà¸³à¸™à¸§à¸™à¸•à¹‰à¸­à¸‡à¹€à¸›à¹‡à¸™à¸•à¸±à¸§à¹€à¸¥à¸‚à¸šà¸§à¸',
      'â€¢ à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡ 1 - 10,000',
      '',
      'ðŸ’¡ à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:',
      'â€¢ "à¹‚à¸„à¹‰à¸ 30 à¸ˆà¸³à¸™à¸§à¸™ 5" âœ…',
      'â€¢ "à¹‚à¸„à¹‰à¸ 30 -5" âŒ',
      'â€¢ "à¹‚à¸„à¹‰à¸ 30 99999" âŒ'
    ]
  }),
  
  // Permission errors
  NO_PERMISSION: (action) => ({
    message: `ðŸ”’ à¸„à¸¸à¸“à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œ: ${action}`,
    help: [
      'ðŸ’¡ à¸—à¸³à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£:',
      'â€¢ à¸•à¸´à¸”à¸•à¹ˆà¸­à¹à¸­à¸”à¸¡à¸´à¸™à¹€à¸žà¸·à¹ˆà¸­à¸‚à¸­à¸ªà¸´à¸—à¸˜à¸´à¹Œ',
      'â€¢ à¸žà¸´à¸¡à¸žà¹Œ "help" à¹€à¸žà¸·à¹ˆà¸­à¸”à¸¹à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¹„à¸”à¹‰'
    ]
  }),
  
  // System errors
  SYSTEM_ERROR: {
    message: 'âŒ à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¸‚à¸­à¸‡à¸£à¸°à¸šà¸š',
    help: [
      'ðŸ’¡ à¸à¸£à¸¸à¸“à¸²:',
      'â€¢ à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆà¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡à¹ƒà¸™à¸­à¸µà¸à¸ªà¸±à¸à¸„à¸£à¸¹à¹ˆ',
      'â€¢ à¸–à¹‰à¸²à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰ à¸•à¸´à¸”à¸•à¹ˆà¸­à¹à¸­à¸”à¸¡à¸´à¸™',
      'â€¢ à¸£à¸°à¸šà¸šà¸ˆà¸°à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¹„à¸§à¹‰à¹à¸¥à¹‰à¸§'
    ]
  },
  
  RATE_LIMIT: (resetIn) => ({
    message: 'â° à¸„à¸¸à¸“à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹€à¸£à¹‡à¸§à¹€à¸à¸´à¸™à¹„à¸›',
    help: [
      `ðŸ’¡ à¸à¸£à¸¸à¸“à¸²à¸£à¸­ ${resetIn} à¸§à¸´à¸™à¸²à¸—à¸µ`,
      '',
      'à¸£à¸°à¸šà¸šà¸ˆà¸³à¸à¸±à¸”à¸„à¸§à¸²à¸¡à¸–à¸µà¹ˆà¹€à¸žà¸·à¹ˆà¸­à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸œà¸´à¸”à¸›à¸à¸•à¸´'
    ]
  }),
  
  // Voice errors
  VOICE_TRANSCRIPTION_FAILED: {
    message: 'âŒ à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸Ÿà¸±à¸‡à¹€à¸ªà¸µà¸¢à¸‡à¹„à¸”à¹‰à¸Šà¸±à¸”à¹€à¸ˆà¸™',
    help: [
      'ðŸ’¡ à¸à¸£à¸¸à¸“à¸²:',
      'â€¢ à¸žà¸¹à¸”à¸Šà¹‰à¸²à¹à¸¥à¸°à¸Šà¸±à¸”à¹€à¸ˆà¸™',
      'â€¢ à¸¥à¸”à¹€à¸ªà¸µà¸¢à¸‡à¸£à¸šà¸à¸§à¸™à¸£à¸­à¸šà¸‚à¹‰à¸²à¸‡',
      'â€¢ à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸—à¸µà¹ˆà¹€à¸‡à¸µà¸¢à¸š',
      'â€¢ à¸–à¸·à¸­à¹‚à¸—à¸£à¸¨à¸±à¸žà¸—à¹Œà¹ƒà¸à¸¥à¹‰à¸›à¸²à¸',
      '',
      'à¸«à¸£à¸·à¸­à¸žà¸´à¸¡à¸žà¹Œà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹à¸—à¸™à¸à¹‡à¹„à¸”à¹‰à¸„à¹ˆà¸°'
    ]
  },
  
  VOICE_NOT_SUPPORTED: {
    message: 'âŒ à¸£à¸°à¸šà¸šà¹€à¸ªà¸µà¸¢à¸‡à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸žà¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™',
    help: [
      'ðŸ’¡ à¹ƒà¸™à¸‚à¸“à¸°à¸™à¸µà¹‰:',
      'â€¢ à¸à¸£à¸¸à¸“à¸²à¹ƒà¸Šà¹‰à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹à¸—à¸™',
      'â€¢ à¹à¸­à¸”à¸¡à¸´à¸™à¸à¸³à¸¥à¸±à¸‡à¹à¸à¹‰à¹„à¸‚à¸£à¸°à¸šà¸š',
      'â€¢ à¸ˆà¸°à¹à¸ˆà¹‰à¸‡à¹€à¸¡à¸·à¹ˆà¸­à¸žà¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™'
    ]
  }
};

function formatError(errorKey, ...args) {
  let error = ERROR_MESSAGES[errorKey];
  
  if (typeof error === 'function') {
    error = error(...args);
  }
  
  if (!error) {
    error = ERROR_MESSAGES.SYSTEM_ERROR;
  }
  
  let message = error.message;
  
  if (error.help && error.help.length > 0) {
    message += '\n\n' + error.help.join('\n');
  }
  
  return message;
}

// Quick error responses
const QuickErrors = {
  cannotParse: () => formatError('CANNOT_PARSE'),
  ambiguousProduct: (name, matches) => formatError('AMBIGUOUS_PRODUCT', name, matches),
  outOfStock: (item, requested, available) => formatError('OUT_OF_STOCK', item, requested, available),
  productNotFound: (name) => formatError('PRODUCT_NOT_FOUND', name),
  orderNotFound: (orderNo) => formatError('ORDER_NOT_FOUND', orderNo),
  invalidQuantity: (qty) => formatError('INVALID_QUANTITY', qty),
  noPermission: (action) => formatError('NO_PERMISSION', action),
  systemError: () => formatError('SYSTEM_ERROR'),
  rateLimit: (seconds) => formatError('RATE_LIMIT', seconds),
  voiceError: () => formatError('VOICE_TRANSCRIPTION_FAILED'),
  voiceNotSupported: () => formatError('VOICE_NOT_SUPPORTED')
};

module.exports = {
  ERROR_MESSAGES,
  formatError,
  QuickErrors
};